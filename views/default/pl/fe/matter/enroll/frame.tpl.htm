<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <base href="/"/>
        <title>登记活动</title>
        <link href="/static/css/bootstrap.min.css" rel="stylesheet">
        <link href="/static/css/bootstrap-switch.min.css" rel="stylesheet">
        <link href="/static/css/font-awesome.min.css" rel="stylesheet">
        <link href="/static/css/tms.css?_=2" rel="stylesheet">
        <link href="/views/default/pl/fe/matter/enroll/frame.css?_=4" rel="stylesheet">
    </head>
    <body ng-controller='ctrlFrame' ng-cloak class='ng-cloak'>
        <nav class='navbar navbar-default navbar-fixed-top tms-large'>
            <ul class='nav navbar-nav'>
                <li><a href='/rest/pl/fe/site/console?site={{siteId}}' target='_self'>工作台</a></li>
            </ul>
            <form class='navbar-form'>
                <div class='form-group' ng-if="subView==='publish'">
                    <div class='input-group'>
                        <input type='text' class='form-control' size='60' title='{{app.title}}' ng-model='app.title' tms-auto-update tms-wait=1000 tms-update="update('title')">
                        <span class='input-group-btn'>
                            <button uib-popover-template="'appSetting.html'" popover-append-to-body='true' popover-placement="bottom" popover-trigger="outsideClick" class='btn btn-default'><span class="caret"></span></button>
                        </span>
                    </div>
                </div>
            </form>
            <ul class='nav navbar-nav navbar-right' ng-if="subView==='publish'">
                <li><a href="/rest/pl/fe/matter/enroll/record?site={{siteId}}&id={{id}}" target='_self'>查看数据</a></li>
            </ul>
            <ul class='nav navbar-nav navbar-right' ng-if="subView==='record'">
                <li><a href="/rest/pl/fe/matter/enroll/schema?site={{siteId}}&id={{id}}" target='_self'>编辑登记项</a></li>
                <li><a href="/rest/pl/fe/matter/enroll/publish?site={{siteId}}&id={{id}}" target='_self'>发布设置</a></li>
                <li><a ng-if="app.scenario==='voting'" href="/rest/pl/fe/matter/enroll/stat?site={{siteId}}&id={{id}}" target='_self'>统计报告</a></li>
            </ul>
        </nav>
        <div class='container'>
            <div class='row' ng-view></div>
        </div>
        <script type="text/ng-template" id="appSetting.html">
            <div id="appSetting" ng-controller="ctrlApp">
                <div class='form-group'>
                    <select class='form-control' ng-model="app.scenario" ng-change="update('scenario');">
                        <option value=''></option>
                        <option value='registration'>报名</option>
                        <option value='voting'>评价</option>
                        <option value='group_week_report'>周报</option>
                    </select>
                </div>
                <hr>
                <div class='form-group compact'>
                    <label>允许每用户登记条数</label>
                    <input type='text' class='form-control' ng-model="app.count_limit" tms-auto-update tms-wait=1000 tms-update="update('count_limit')">
                </div>
                <hr>
                <a href="/rest/pl/fe/matter/enroll/event?site={{siteId}}&id={{id}}">活动进入规则</a>
                <hr>
                <button class='btn btn-default btn-block' ng-click="exportAsTemplate()">导出活动定义</button>
                <button class='btn btn-default btn-block' ng-click="remove()">删除活动</button>
                <button class='btn btn-default btn-block' ng-click="shareAsTemplate()">保存为模版</button>
            <div>
        </script>
        <script src="/static/js/jquery.min.js"></script>
        <script src="/static/js/jquery-ui.min.js"></script>
        <script src="/static/js/bootstrap.min.js"></script>
        <script src="/static/js/bootstrap-switch.min.js"></script>
        <script src="/static/js/angular.min.js"></script>
        <script src="/static/js/angular-route.min.js"></script>
        <script src="/static/js/angular-sanitize.min.js"></script>
        <script src="/static/js/ui-bootstrap-tpls.min.js"></script>
        <script src="/static/js/angular-bootstrap-switch.min.js"></script>
        <script src="/static/js/tinymce/tinymce.min.js"></script>
        <script src="/static/js/resumable.js"></script>
        <script src="/static/js/FileSaver.min.js "></script>
        <script src="/static/js/ZeroClipboard.min.js"></script>
        <script src="/static/js/highcharts.js"></script>
        <script src="/static/js/highcharts/exporting.js"></script>
        <script src="/static/js/ui-tms.js?_=4"></script>
        <script src="/static/js/xxt.ui.js?_=4"></script>
        <script src="/static/js/xxt.ui.tmplshop.js?_=1"></script>
        <script src="/views/default/pl/fe/_module/channel.js?_=1"></script>
        <script src="/views/default/pl/fe/_module/matter.service.js?_=1"></script>
        <script src="/views/default/pl/fe/matter/enroll/lib/enroll.service.js?_=1"></script>
        <script src="/views/default/pl/fe/matter/enroll/lib/enroll.tinymce.js?_=2"></script>
        <script src="/static/js/require.js" data-main="/views/default/pl/fe/matter/enroll/frame-loader.js?_=6"></script>
    </body>
</html>