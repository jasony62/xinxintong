<div id='preview-view' class='row'>
    <!-- preview -->
    <div class='col-md-3' ng-controller="ctrlApp">
        <div class='tile'>
            <div class="form-group compact" ng-if="!app.mission">
                <button class='btn btn-success' ng-click="assignMission()">指定项目</button>
            </div>
            <div class='form-group compact'>
                <label>活动标题</label>
                <input type='text' class='form-control' ng-model='app.title' tms-auto-update tms-wait=1000 tms-update="update('title')">
            </div>
            <div class='form-group compact' ng-if="app.mission.multi_phase==='Y'">
                <label>所属项目阶段</label>
                <select class='form-control' ng-model="app.mission_phase_id" ng-change="choosePhase()" ng-options="phase.phase_id as phase.title for phase in phases">
                </select>
            </div>
            <div class='form-group compact' ng-if="app.scenarioConfig.can_period!=='D'">
                <label>登记开始时间</label>
                <tms-datepicker class='tms-datepicker' tms-title='开始时间' tms-date='app.start_at' tms-state='start_at'></tms-datepicker>
            </div>
            <div class='form-group compact' ng-if="app.scenarioConfig.can_period!=='D'">
                <label>登记截止时间</label>
                <tms-datepicker class='tms-datepicker' tms-title='结束时间' tms-date='app.end_at' tms-state='end_at'></tms-datepicker>
            </div>
        </div>
        <div class='tile'>
            <div class='form-group'>
                <div class='checkbox'>
                    <label>
                        <input type='checkbox' ng-true-value="'Y'" ng-false-value="'N'" ng-model='app.use_site_header' ng-change="update('use_site_header');">使用站点页眉</label>
                </div>
                <div class='checkbox'>
                    <label>
                        <input type='checkbox' ng-true-value="'Y'" ng-false-value="'N'" ng-model='app.use_site_footer' ng-change="update('use_site_footer');">使用站点页脚</label>
                </div>
            </div>
            <div class='form-group' ng-if="app.mission_id>0">
                <div class='checkbox'>
                    <label class='checkbox-inline'>
                        <input type='checkbox' ng-true-value="'Y'" ng-false-value="'N'" ng-model='app.use_mission_header' ng-change="update('use_mission_header');">使用项目页眉</label>
                </div>
                <div class='checkbox'>
                    <label class='checkbox-inline'>
                        <input type='checkbox' ng-true-value="'Y'" ng-false-value="'N'" ng-model='app.use_mission_footer' ng-change="update('use_mission_footer');">使用项目页脚</label>
                </div>
            </div>
        </div>
    </div>
    <div class='col-md-5' style='text-align:center'>
        <iframe id='simulator' ng-src={{previewURL}}></iframe>
    </div>
    <div class='col-md-4'>
        <div class='tile'>
            <div class="panel panel-default">
                <div class="panel-heading">模拟用户打开时间</div>
                <div class="panel-body">
                    <div class='radio'>
                        <label><input type='radio' name='openAt' value='before' ng-model="params.openAt" ng-disabled="app.start_at==='0'">开始时间之前<span ng-if="app.start_at!=='0'">（{{app.start_at*1000|date:'yy-MM-dd HH:mm'}}）</span></label>
                    </div>
                    <div class='radio'>
                        <label><input type='radio' name='openAt' value='ontime' ng-model="params.openAt" >允许登记时间</label>
                    </div>
                    <div class='radio' ng-disabled="!app.start_at">
                        <label><input type='radio' name='openAt' value='after' ng-model="params.openAt" ng-disabled="app.end_at==='0'">结束时间之后<span ng-if="app.end_at!=='0'">（{{app.end_at*1000|date:'yy-MM-dd HH:mm'}}）</span></label>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- end preview -->
    <!-- bottom navbar -->
    <nav class="navbar navbar-default navbar-fixed-bottom">
        <div class="container-fluid" style='text-align:center'>
            <form class="navbar-form" style='display:inline-block'>
                <a class='btn btn-lg btn-success' href="/rest/pl/fe/matter/enroll/page?site={{siteId}}&id={{id}}">编辑页面</a>
                <button class='btn btn-lg btn-success' ng-click="publish()">收集数据</button>
            </form>
            <form class="navbar-form navbar-right" style='display:inline-block'>
                <button class='btn btn-lg btn-default' ng-click="remove()">删除活动</button>
            </form>
        </div>
    </nav>
    <!-- end bottom navbar -->
</div>