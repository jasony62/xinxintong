<div id='viewMatter' class="col-md-12">
    <nav class="navbar navbar-default">
        <div class='container-fluid'>
            <ul class="nav navbar-nav">
                <li ng-class="{'active':matterType===''}"><a href='#' ng-click="matterType=''">全部</a></li>
                <li ng-class="{'active':matterType===app}" ng-repeat="app in cstApp.matterNames.appOrder"><a href='#{{app}}'>{{cstApp.matterNames.app[app]}}</a></li>
            </ul>
            <form class='nav navbar-form pull-left'>
                <div class="form-group" ng-if="matterType==='enroll'">
                    <select class='form-control' ng-model="matterScenario" ng-change="chooseScenario(matterScenario)" ng-options="k as v for (k,v) in scenarioNames.enroll">
                        <option value>全部场景</option>
                    </select>
                </div>
                <div class='form-group'>
                    <div class='input-group'>
                        <input type='input' class='form-control' placeholder='按名称筛选' ng-model='criteria.byTitle'>
                        <div class='input-group-btn'>
                            <button class='btn btn-default' ng-click="list()"><span class='glyphicon glyphicon-search'></span></button>
                            <button class='btn btn-default' ng-click="criteria.byTitle=''"><span class='glyphicon glyphicon-remove'></span></button>
                        </div>
                    </div>
                </div>
                <div class='form-group' ng-if="mission.phases.length">
                    <select class="form-control" ng-model="criteria.pid" ng-change="list()">
                        <option value="ALL">全部{{cstApp.naming.phase}}</option>
                        <option value="{{phs.phase_id}}" ng-repeat="phs in phases">{{phs.title}}</option>
                    </select>
                </div>
            </form>
            <form class="navbar-form navbar-right" ng-if="matterType">
                <button class='btn btn-default' ng-click="addMatter()"><i class='glyphicon glyphicon-plus'></i> <span>新建</span></button>
            </form>
        </div>
    </nav>
    <table class='table table-bordered'>
        <thead>
            <tr>
                <th style='width:48px'>序号</th>
                <th style='width:90px' ng-if="matterType==='enroll'">场景</th>
                <th>名称</th>
                <th ng-if="matterType=='signin'" style='width:80px'>签到轮次</th>
                <th ng-if="matterType=='enroll'||matterType=='signin'" style='width:64px'>记录数</th>
                <th ng-if="matterType=='enroll'" style='width:64px'>填写人</th>
                <th ng-if="matterType=='enroll'" style='width:64px'>评论数</th>
                <th style='width:140px'>创建人</th>
                <th style='width:120px'>创建时间</th>
                <th style='width:220px'>操作</th>
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat='m in matters'>
                <td>{{$index+1}}</td>
                <td ng-if="matterType==='enroll'">{{scenarioNames.enroll[m.scenario||m.type]}}</td>
                <td ng-click="openMatter(m)" style='cursor:pointer;'>{{m.title}}</td>
                <td data-th='签到轮次' ng-if="matterType=='signin'"><span>{{m.opData[0].title}}</span></td>
                <td data-th='记录数' ng-if="matterType=='enroll'" ng-click="openMatter(m,'record')" title='点击查看详细数据'><span>{{m.opData[0].total}}</span></td>
                <td data-th='记录数' ng-if="matterType=='signin'" ng-click="openMatter(m,'record')" title='点击查看详细数据'><span>{{m.opData[0].total}}</span></td>
                <td data-th='填写人' ng-if="matterType=='enroll'" ng-click="openMatter(m,'enrollee')" title='点击查看详细数据'><span>{{m.opData[0].enrollee_num}}</span></td>
                <td data-th='评论数' ng-if="matterType=='enroll'" ng-click="openMatter(m,'remark')" title='点击查看详细数据'><span>{{m.opData[0].remark_total}}</span></td>
                <td>{{m._operator||m.creater_name||m.modifier_name}}</td>
                <td>{{(m._operateAt||m.modify_at||m.create_at)*1000|date:'yy-MM-dd HH:mm'}}</td>
                <td ng-switch on="m.type">
                    <div ng-switch-when="group">
                        <button class='btn btn-sm btn-default' ng-click="openMatter(m,'main')">定义</button>
                        <button class='btn btn-sm btn-default' ng-click="openMatter(m,'player')">数据</button>
                        <button class='btn btn-sm btn-default' ng-click="copyMatter($event,m)">复制</button>
                        <button class='btn btn-sm btn-default' title='删除' ng-click="removeMatter($event,m)">删除</button>
                    </div>
                    <div ng-switch-when="enroll">
                        <button class='btn btn-sm btn-default' ng-click="openMatter(m,'preview')">预览</button>
                        <button class='btn btn-sm btn-default' ng-click="openMatter(m,'entry')">发放</button>
                        <button class='btn btn-sm btn-default' ng-click="copyMatter($event,m)">复制</button>
                        <button class='btn btn-sm btn-default' title='删除' ng-click="removeMatter($event,m)">删除</button>
                    </div>
                    <div ng-switch-when="signin">
                        <button class='btn btn-sm btn-default' ng-click="openMatter(m,'preview')">预览</button>
                        <button class='btn btn-sm btn-default' ng-click="openMatter(m,'entry')">发放</button>
                        <button class='btn btn-sm btn-default' ng-click="copyMatter($event,m)">复制</button>
                        <button class='btn btn-sm btn-default' title='删除' ng-click="removeMatter($event,m)">删除</button>
                    </div>
                    <div ng-switch-when="wall">
                        <button class='btn btn-sm btn-default' ng-click="openMatter(m,'main')">进入</button>
                        <button class='btn btn-sm btn-default' ng-click="copyMatter($event,m)">复制</button>
                        <button class='btn btn-sm btn-default' title='删除' ng-click="removeMatter($event,m)">删除</button>
                    </div>
                    <div ng-switch-default>
                        <button class='btn btn-sm btn-default' ng-click="openMatter(m,'main')">进入</button>
                        <button class='btn btn-sm btn-default' ng-click="copyMatter($event,m)">复制</button>
                        <button class='btn btn-sm btn-default' ng-if="m.type!= 'wall'" ng-click="removeMatter($event,m)">删除</button>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>