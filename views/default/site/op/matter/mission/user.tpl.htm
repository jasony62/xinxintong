<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta content="width=device-width,user-scalable=no,initial-scale=1.0" name="viewport">
    <base href="/" />
    <title>
        <?php TPL::pt('title');?>
    </title>
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <link href="/views/default/site/op/matter/mission/user.css?_=1" rel="stylesheet">
</head>

<body ng-controller="ctrlMain">
    <div class='container ng-cloak' ng-cloak>
        <div id='times' class='row'>
            <div ng-repeat="time in times">
                <div class='col-xs-2 timeline' ng-class="{'pending':time>currentTime}">
                    <div class='date' ng-bind="time*1000|date:'MM-dd'"></div>
                    <div class='time' ng-bind="time*1000|date:'HH:mm'"></div>
                </div>
                <div class='col-xs-10' ng-repeat="matter in matters[time]" ng-switch on="matter.type">
                    <div class='thumbnail track' ng-class="matter.indicator.state">
                        <div class='title' ng-bind="matter.title"></div>
                        <div class='row' ng-switch-when="enroll">
                            <div class='col-xs-12'>
                                <label>记录数量</label>
                                <div ng-bind="matter.user.enroll_num||0"></div>
                            </div>
                            <div class='col-xs-6' ng-if="matter.indicator.score">
                                <label>得分</label>
                                <div ng-bind="matter.user.score||0"></div>
                            </div>
                            <div class='col-xs-6' ng-if="matter.indicator.score">
                                <label>得分排名</label>
                                <div ng-bind="matter.user.rank.score||0"></div>
                            </div>
                            <div class='col-xs-6' ng-if="matter.indicator.coin">
                                <label>积分</label>
                                <div ng-bind="matter.user.user_total_coin||0"></div>
                            </div>
                            <div class='col-xs-6' ng-if="matter.indicator.coin">
                                <label>积分排名</label>
                                <div ng-bind="matter.user.rank.user_total_coin||0"></div>
                            </div>
                            <div class='col-xs-6' ng-if="matter.indicator.remark">
                                <label>获得留言</label>
                                <div ng-bind="matter.user.remark_num||0"></div>
                            </div>
                            <div class='col-xs-6' ng-if="matter.indicator.remark">
                                <label>发表留言</label>
                                <div ng-bind="matter.user.do_remark_num||0"></div>
                            </div>
                            <div class='col-xs-6' ng-if="matter.indicator.like">
                                <label>获得赞同</label>
                                <div ng-bind="matter.user.like_num||0"></div>
                            </div>
                            <div class='col-xs-6' ng-if="matter.indicator.like">
                                <label>表示赞同</label>
                                <div ng-bind="matter.user.do_like_num||0"></div>
                            </div>
                            <div class='col-xs-12' ng-if="matter.indicator.end_submit" ng-switch on="matter.indicator.end_submit">
                                <div ng-switch-when="R">！本活动将于<span style='color:orangered;'>{{matter.end_submit_at*1000|date:'MM-dd HH:mm'}}</span>停止提交</div>
                                <div ng-switch-when="E">！本活动已于<span style='color:orangered;'>{{matter.end_submit_at*1000|date:'MM-dd HH:mm'}}</span>停止提交</div>
                            </div>
                            <div class='col-xs-12' ng-if="matter.indicator.end" ng-switch on="matter.indicator.end">
                                <div ng-switch-when="R">！本活动将于<span style='color:orangered;'>{{matter.end_at*1000|date:'MM-dd HH:mm'}}</span>结束</div>
                                <div ng-switch-when="E">！本活动已于<span style='color:orangered;'>{{matter.end_at*1000|date:'MM-dd HH:mm'}}</span>结束</div>
                            </div>
                        </div>
                        <div class='row' ng-switch-when="signin">
                            <div class='col-xs-12'>
                                <label>签到次数</label>
                                <div ng-bind="matter.record.signin_num||0"></div>
                            </div>
                            <div class='col-xs-6' ng-repeat="rnd in matter.rounds">
                                <label title="{{rnd.title}}">{{rnd.title}}</label>
                                <div ng-if="matter.record.signin_log[rnd.rid]" ng-class="{'signin_late':matter.record._signinLate[rnd.rid]}" ng-bind="matter.record.signin_log[rnd.rid]*1000|date:'yy-MM-dd HH:mm'"></div>
                                <div ng-if="!matter.record.signin_log[rnd.rid]">未签到</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/ng-template" id="chooseUser.html">
        <div class="modal-body ">
            <div class="radio" ng-repeat="user in users">
                <label>
                    <input type='radio' name='user' value="{{$index}}" ng-model='chosen.index'>{{user.nickname}}</label>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-default" ng-click="cancel() ">关闭</button>
            <button class="btn btn-default" ng-click="ok() ">确定</button>
        </div>
    </script>
    <script src="<?php echo auto_version('/static/js/xxt.ui.error.js');?>"></script>
    <script src="/static/js/angular.min.js"></script>
    <script src="/static/js/angular-sanitize.min.js"></script>
    <script src="/static/js/ui-bootstrap-tpls.min.js"></script>
    <script src="<?php echo auto_version('/asset/js/xxt.ui.http.js');?>"></script>
    <script src="/static/js/require.js" defer async data-main="/views/default/site/op/matter/mission/user-loader.js?_=1"></script>
</body>

</html>